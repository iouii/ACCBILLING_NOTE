@using ACCBILLING_NOTE.Models
<div id="ShntableArea" style=" background-color:#ffffff ; border:1px solid #000000; padding:15px;  margin-top:-140px;" class="col-8 scaled">
    <div style="padding-left:40px; padding-right:40px; padding-top:90px; padding-bottom:50px;">
        <div style="padding-left:35px; padding-right:35px;" class="table">
            <table class="table table-sm table-borderless">
                <tr style="font-size:35px; font-weight:700; ">
                    <td style="text-decoration-line:underline;">OGURA CLUTCH THAILAND CO.,LTD.</td>
                    <td><b id="textOriginal" style="font-size:16px;"></b></td>
                </tr>
                <tr></tr>
            </table>
        </div>
        <div style="padding-left:35px; padding-right:35px;" class="table">
            @foreach (InvoiceCus cus in (InvoiceCus[])ViewBag.cus)
            {
                <table class="table table-sm table-borderless" style="font-size:14px; margin-top:5px;">
                    <tr>
                        <td rowspan="2" style="word-wrap: break-word; max-width:40px;">@cus.custName <br /> @cus.custAdress</td>
                        <td style="width:180px;"></td>
                        <td style="width:60px;">No.:</td>
                        <td style="width:120px; font-size:12px;" id="TreiTwo" onclick="editTDateTwo(this)">@cus.custAdressii</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Date :</td>
                        <td id="pirntDateNow" >@ViewBag.dater</td>
                    </tr>

                    <tr>

                        <td>ATTAN:@cus.custAdressi</td>
                        <td></td>
                        <td></td>
                    </tr>

                    <tr style="font-size:15px;">
                        <td>Gentelman:</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr style="font-size:15px;">
                        <td>We are pleasef to enclose the following <br />each one price of invoice</td>
                        <td></td>
                        <td></td>
                    </tr>
                </table>
            }
        </div>


        <div style="padding-left:35px; padding-right:35px;" class="table">
            <table class="table table-borderless table-sm" id="tableOc">
                <thead style="border-bottom:1px solid #000000">
                    <tr>
                        <td align="center" colspan="4 "><h2>-Collection Statement -</h2></td>
                    </tr>
                    <tr style="font-size:16px;">

                        <td style="width:200px;">INVOICE NO</td>
                        <td align="center">INVOICE DATE</td>
                        <td align="center" onclick="editCur(this)">AMOUNT (THB)  </td>
                        <td align="center" onclick="editDate(this)">DUE DATE </td>

                    </tr>

                </thead>
                <tbody style="border-bottom:1px solid #000000">
                    @*@{ var a = 1;}*@

                    @foreach (Invoice v in (Invoice[])ViewBag.resulii)
                    {

                        <tr style="font-size:15px;">


                            <td>@v.invoiceNo</td>
                            <td align="center">@v.invoiceDate</td>
                            <td align="right">@v.invoiceAm1Cal</td>
                            <td align="center">@v.invoiceDue</td>


                        </tr>
                        //a++;
                    }


                    @{
                        for (var i = ViewBag.count + 1; i <= 15; i++)
                        //for (var i = 1; i <= 15; i++)
                        {
                            <tr style="font-size:15px; ">

                                <td>&nbsp;</td>
                                <td></td>
                                <td></td>
                                <td></td>


                            </tr>
                        }



                    }

                </tbody>
                <tr>

                    <td>TOTAL AMOUNT :</td>
                    <td colspan="4" align="center">@ViewBag.sum1</td>
                </tr>

            </table>

        </div>
       @foreach (bankTranfer ba1 in (bankTranfer[])ViewBag.bank)
       {

        <div style="padding-left:20px; padding-right:20px;" class="table">
            <table class="table table-sm table-borderless" style="font-size:16px;" id="tban">
                <tbody>
                    <tr>
                        <td>TRANFER BANK:</td>
                        <td style="width:320px;"></td>
                    </tr>
                    <tr>
                        <td id='IdBank' style='display:none;'>@ba1.bId</td>
                        <td><b>@ba1.bNameEn</b></td>
                        <td></td>
                    </tr>
                    <tr>
                        
                        <td rowspan='2'>@ba1.bAddressEn</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>&nbsp;</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>ACC.NO. : @ba1.bAccNo</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>BRANCH : @ba1.bBranch</td>
                        <td>Your very truly,</td>
                    </tr>
                    <tr>
                        <td>SWIFT CODE : @ba1.bSwiftCode</td>
                        <td><b>OGURA CLUTCH THAILAND CO.,LTD.</b></td>
                    </tr>
                    <tr>
                        <td>&nbsp;</td>
                        <td></td>
                    </tr>

                    <tr>
                        <td>&nbsp;</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>&nbsp;</td>
                        <td style="border-bottom:1px solid #000000"></td>
                    </tr>
                </tbody>
            </table>

        </div>
       }
    </div>
</div>

<div id="printableArea" style=" background-color:#ffffff ; border:1px solid #000000; padding:15px; display:none" class="col-12">
    <div style="padding-left:20px; padding-right:20px; margin-top:90px;">
        <div style="padding-left:20px; padding-right:20px;" class="table">
            <table class="table table-sm table-borderless">
                <tr style="font-size:45px; font-weight:700; ">
                    <td style="text-decoration-line:underline;">OGURA CLUTCH THAILAND CO.,LTD.</td>
                    <td><b id="textOriginalP" style="font-size:16px;"></b></td>
                </tr>
                <tr></tr>
            </table>
        </div>
        <div style="padding-left:20px; padding-right:20px;" class="table">
            @foreach (InvoiceCus cus in (InvoiceCus[])ViewBag.cus)
            {
                <table class="table table-sm table-borderless" style="font-size:17px; margin-top:5px;">
                    <tr>
                        <td rowspan="2" style="word-wrap:break-word; max-width:80px;">@cus.custName <br /> @cus.custAdress</td>
                        <td style="width:260px;"></td>
                        <td style="width:60px;">No. :</td>
                        <td style="width:150px;" id="TreiTwos" onclick="editTDateTwo(this)">@cus.custAdressii</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Date :</td>
                        <td id="pirntDateNow">@ViewBag.dater</td>
                    </tr>

                    <tr>

                        <td>ATTAN:@cus.custAdressi</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>

                    <tr style="font-size:14px;">
                        <td>Gentelman:</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr style="font-size:14px;">
                        <td>We are pleasef to enclose the following <br />each one price of invoice</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </table>
            }
        </div>


        <div style="padding-left:20px; padding-right:20px;" class="table">
            <table class="table table-borderless table-sm" id="tableOP">
                <thead style="border-bottom:1px solid #000000">
                    <tr>
                        <td align="center" colspan="4 "><h2>-Collection Statement -</h2></td>
                    </tr>
                    <tr style="font-size:16px;">

                        <td style="width:200px;">INVOICE NO</td>
                        <td align="center">INVOICE DATE</td>
                        <td align="center">AMOUNT (THB)  </td>
                        <td align="center">DUE DATE </td>

                    </tr>

                </thead>
                <tbody style="border-bottom:1px solid #000000">
                    @*@{ var a = 1;}*@

                    @foreach (Invoice v in (Invoice[])ViewBag.resulii)
                    {

                        <tr style="font-size:16px;">


                            <td>@v.invoiceNo</td>
                            <td align="center">@v.invoiceDate</td>
                            <td align="right">@v.invoiceAm1Cal  </td>
                            <td align="center" id="tbduedate">@v.invoiceDue</td>


                        </tr>
                        //a++;
                    }


                    @{
                        for (var i = ViewBag.count + 1; i <= 15; i++)
                        // for (var i = 1; i <= 15; i++)
                        {
                            <tr style="font-size:16px; ">

                                <td>&nbsp;</td>
                                <td></td>
                                <td></td>
                                <td></td>


                            </tr>
                        }



                    }

                </tbody>
                <tr>

                    <td>TOTAL AMOUNT :</td>
                    <td colspan="4" align="center">@ViewBag.sum1</td>
                </tr>

            </table>

        </div>
@foreach (bankTranfer ba in (bankTranfer[])ViewBag.bank)
                    {

        <div style="padding-left:20px; padding-right:20px;" class="table">
            <table class="table table-sm table-borderless" style="font-size:16px;" id="tban">
                <tbody>
                    <tr>
                        <td>TRANFER BANK:</td>
                        <td style="width:320px;"></td>
                    </tr>
                    <tr>
                        <td>@ba.bNameEn</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td rowspan='2'>@ba.bAddressEn</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>&nbsp;</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>ACC.NO. : @ba.bAccNo</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>BRANCH : @ba.bBranch</td>
                        <td>Your very truly,</td>
                    </tr>
                    <tr>
                        <td>SWIFT CODE : @ba.bSwiftCode</td>
                        <td><b>OGURA CLUTCH THAILAND CO.,LTD.</b></td>
                    </tr>
                    <tr>
                        <td>&nbsp;</td>
                        <td></td>
                    </tr>

                    <tr>
                        <td>&nbsp;</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>&nbsp;</td>
                        <td style="border-bottom:1px solid #000000"></td>
                    </tr>
                </tbody>
            </table>

        </div>
}
    </div>
</div>

<div class="col-3">
    <div class="table-responsive" style="margin-top:35px;">
        <table class="table table-sm table-bordered">
            <thead style="background-color:#5A6268; color:#ffffff">
                <tr>
                    <td align="right" colspan="2">
                        <input type="button" onclick="printDiv('printableArea')" value="PRINT" class="btn btn-sm btn-success" style="border-radius:0px; color:#ffffff" />
                    </td>
                </tr>


            </thead>

        </table>


    </div>
</div>


<script>

    function editDate(r) {



        var i = r.parentNode.rowIndex;

        var table = document.getElementById("tableOc");
        var tableP = document.getElementById("tableOP");

        var e = table.rows[3].cells[3].innerText;

        var al = prompt('Would you like to change currency?', e)


        // var af = table.rows[i].cells[3].innerHTML = al;

        for (var c = 2; c < @ViewBag.datacount +2 ; c++) {

            table.rows[c].cells[3].innerHTML = al;
        }

        for (s = 2; s < @ViewBag.datacount +2; s++) {

            tableP.rows[s].cells[3].innerHTML = al;
        }

        //  var changeDue = tableP.rows[i].cells[3].innerHTML = al;

    }
</script>

<script>

    function editTDateTwo(r) {



        var ra = document.getElementById("TreiTwo").innerText;


        //var e = ra.nodeValue();

        var al = prompt('Would you like to change due date?', ra);

        // alert(i);
        $("#TreiTwo").text(al);
        $("#TreiTwos").text(al);

    }
</script>
